{% extends "base.html" %}

{% block title %}{{ file_name }} - {{ dataset_name }} - Kirin{% endblock %}

{% block breadcrumb %}
<span class="breadcrumb-separator">></span>
<a href="/backend/{{ backend_id }}">{{ backend_id }}</a>
<span class="breadcrumb-separator">></span>
<a href="/backend/{{ backend_id }}/{{ dataset_name }}">{{ dataset_name }}</a>
<span class="breadcrumb-separator">></span>
<span>{{ file_name }}</span>
{% endblock %}

{% block header_title %}{{ file_name }}{% endblock %}
{% block header_description %}
    {{ "%.1f"|format(file_size / 1024) }} KB •
    {% if is_binary %}
    Binary file ({{ content_type or "unknown type" }})
    {% else %}
    Text preview
    {% if truncated %}
    • First 1000 lines
    {% endif %}
    {% endif %}
{% endblock %}

{% block content %}
<div class="space-y-4">
    <!-- File Actions -->
    <div class="flex justify-between items-center">
        <div class="flex gap-2">
            <a href="/backend/{{ backend_id }}/{{ dataset_name }}/file/{{ file_name }}/download" class="btn btn-primary">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7,10 12,15 17,10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Download File
            </a>
        </div>

        <a href="/backend/{{ backend_id }}/{{ dataset_name }}" class="btn btn-ghost">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 12h14"></path>
                <path d="M12 5l7 7-7 7"></path>
            </svg>
            Back to Dataset
        </a>
    </div>

    <!-- File Content -->
    <div class="panel">
        <div class="panel-header">
            <h2 class="panel-title">File Content</h2>
        </div>
        <div class="panel-content">
            {% if is_binary %}
            <div class="text-center py-12">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" class="mx-auto mb-4 text-muted-foreground">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14,2 14,8 20,8"></polyline>
                </svg>
                <h3 class="text-lg font-semibold mb-2">Binary File</h3>
                <p class="text-muted-foreground mb-4">
                    This file cannot be previewed as text. Download the file to view its contents.
                </p>
                <p class="text-sm text-muted-foreground">
                    File type: {{ content_type or "unknown" }}<br>
                    Size: {{ "%.1f"|format(file_size / 1024) }} KB
                </p>
            </div>
            {% else %}
            <div class="p-0">
                <pre class="p-4 bg-muted text-sm overflow-auto max-h-96"><code>{{ content }}</code></pre>
            </div>
            {% endif %}
        </div>
    </div>

    {% if truncated %}
    <div class="alert alert-warning">
        <strong>Preview limited:</strong> Showing first 1000 lines only. Download the full file to see all content.
    </div>
    {% endif %}
</div>
{% endblock %}
